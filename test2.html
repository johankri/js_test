<html lang="">

<style>
    * {
        margin: 0;
        padding: 0;
    }

    #cards {
        margin: 30px;
        text-align: center;
    }

    .card {
        max-width: 30%;
        max-height: 30vh;
        border-radius: 4.75% / 3.5%;
        box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.5);
        margin: 5px;
    }

    #zoom {
        display: grid;
        height: 100%;
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        margin: auto;
        pointer-events: none;
    }

    #full {
        max-width: 95%;
        max-height: 95vh;
        margin: auto;
        border-radius: 4.75% / 3.5%;
        box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.5);
    }

</style>
<body>
<div id="zoom">
    <img id="full" src="https://cards.scryfall.io/large/front/4/7/47f7d313-8333-41fe-8bfa-c96774dac228.jpg?1680826646" alt="">
</div>
<div id="cards">
</div>
</body>

<script>
    function getRarity(distribution) {
        const random = Math.random()
        let sum = 0
        return Object.keys(distribution).find(key => {
            sum = sum + distribution[key]
            return random < sum
        });
    }

    async function getRandomCard(query) {
        const url = `https://api.scryfall.com/cards/random?q=${encodeURIComponent(query + ' in:booster')}`
        const response = await fetch(url)
        return await response.json()
    }

    async function getSpecialSheetCard(query) {
        const distribution = {"m": (1 / 5) * (1 / 3), "r": (4 / 5) * (1 / 3), "u": 2 / 3}
        const rarity = getRarity(distribution)
        return await getRandomCard(`${query} and r:${rarity}`)
    }

    async function getRare(query) {
        const distribution = {"m": (1 / 7.4) * (1 / 3), "r": (6.4 / 7.4)}
        const rarity = getRarity(distribution)
        return await getRandomCard(`${query} and r:${rarity}`)
    }

    async function getUncommon(query) {
        return await getRandomCard(`${query} and r:u`)
    }

    async function getCommon(query) {
        return await getRandomCard(`${query} and r:c`)
    }

    async function getLand(query) {
        return await getRandomCard(`${query} and t:land`)
    }

    function showZoom(event) {
        document.getElementById("zoom").style.display = "grid"
        document.getElementById("full").src = event.target.src;
    }

    function hideZoom(event) {
        document.getElementById("zoom").style.display = "none"
    }

    async function addImage(card) {
        const cards = document.getElementById("cards")
        const image = document.createElement("img")
        image.className = "card"
        cards.appendChild(image)
        image.src = "Back.jpg"
        image.onmouseover = showZoom;
        image.onmouseout = hideZoom;
        card.then((value) => {
            if (value.card_faces != null) {
                image.src = value.card_faces[0].image_uris.large
            } else {
                image.src = value.image_uris.large
            }
        })
    }

    let cards = []
    cards.push(getSpecialSheetCard("s:MUL"))
    cards.push(getSpecialSheetCard("s:MOM t:Battle"))
    cards.push(getSpecialSheetCard("s:MOM is:doublefaced -t:battle"))
    cards.push(getRare("s:MOM")) // JK: Uncommon
    for (let i = 0; i < 2; i++) {
        cards.push(getUncommon("s:MOM"))
    }
    for (let i = 0; i < 8; i++) {
        cards.push(getCommon("s:MOM"))
    }
    cards.push(getLand("s:MOM"))

    cards.forEach(card => addImage(card))

    // JK: Inga andra double faced cards
    // JK: Inga andra länder
    // JK: Inga dubletter
    // JK: Visa stor bild vid hoover
    // JK: Rare ska vara Uncommon ibland
    // JK: Small images
    // JK: Visa baksida på double faced card
    // JK: Styla Layout som på arenan
    
</script>
</html>
